
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>fart.tools &#8212; FART 0.1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for fart.tools</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2018 Stefan Kroboth</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 &lt;LICENSE-APACHE or</span>
<span class="c1"># http://apache.org/licenses/LICENSE-2.0&gt; or the MIT license &lt;LICENSE-MIT or</span>
<span class="c1"># http://opensource.org/licenses/MIT&gt;, at your option. This file may not be</span>
<span class="c1"># copied, modified, or distributed except according to those terms.</span>
<span class="sd">&quot;&quot;&quot;Convenient helper functions</span>

<span class="sd">Author: Stefan Kroboth &lt;stefan.kroboth@gmail.com&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="k">import</span> <span class="n">savemat</span>
<span class="kn">import</span> <span class="nn">pycuda.gpuarray</span> <span class="k">as</span> <span class="nn">gpuarray</span>
<span class="kn">import</span> <span class="nn">pycuda.driver</span> <span class="k">as</span> <span class="nn">cuda</span>
<span class="kn">from</span> <span class="nn">pycuda.elementwise</span> <span class="k">import</span> <span class="n">ElementwiseKernel</span>

<span class="c1"># pylint: disable=bad-builtin</span>
<span class="c1"># pylint: disable=no-member</span>


<div class="viewcode-block" id="query_yes_no"><a class="viewcode-back" href="../../tools.html#fart.tools.query_yes_no">[docs]</a><span class="k">def</span> <span class="nf">query_yes_no</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ask a yes/no question via raw_input() and return their answer.</span>

<span class="sd">    Snippet adapted from:</span>
<span class="sd">    http://code.activestate.com/recipes/577058-query-yesno/</span>

<span class="sd">    Args:</span>
<span class="sd">        question (str): Question presented to the user.</span>
<span class="sd">        default (str): Default answer; &#39;yes&#39;, &#39;no&#39; or `None`. The latter</span>
<span class="sd">            requires the user to provide an answer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Either &quot;yes&quot; or &quot;no&quot;, depending on the user input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;yes&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;ye&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot; [y/n] &quot;</span>
    <span class="k">elif</span> <span class="n">default</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot; [Y/n] &quot;</span>
    <span class="k">elif</span> <span class="n">default</span> <span class="o">==</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot; [y/N] &quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid default answer: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">default</span><span class="p">)</span>

    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">question</span> <span class="o">+</span> <span class="n">prompt</span><span class="p">)</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">choice</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">elif</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">valid</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">valid</span><span class="p">[</span><span class="n">choice</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please respond with &#39;yes&#39; or &#39;no&#39; (or &#39;y&#39; or &#39;n&#39;).&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_dir"><a class="viewcode-back" href="../../tools.html#fart.tools.create_dir">[docs]</a><span class="k">def</span> <span class="nf">create_dir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="n">skip_question</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="p">,</span>
               <span class="n">question</span><span class="o">=</span><span class="s2">&quot;Directory already exists and files may be&quot;</span> <span class="o">+</span>
               <span class="s2">&quot;overwritten. Proceed?&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience function for creating a directory.</span>

<span class="sd">    If skip_question is `False`, the user will be ask to overwrite the</span>
<span class="sd">    directory if it already exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        dir_name (str): Name of directory.</span>
<span class="sd">        skip_question (bool): If ``True``, directory will either be overwritten</span>
<span class="sd">            or not overwritten without asking the user, depending on the value</span>
<span class="sd">            of `default`.</span>
<span class="sd">        default (str): Default answer if directory already exists (&quot;yes&quot; or</span>
<span class="sd">            &quot;no&quot;).</span>
<span class="sd">        question (str): Question prompted to the user if directory already</span>
<span class="sd">            exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dir_name</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">skip_question</span> <span class="ow">and</span> <span class="n">query_yes_no</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Abort.&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span></div>


<div class="viewcode-block" id="imwrite"><a class="viewcode-back" href="../../tools.html#fart.tools.imwrite">[docs]</a><span class="k">def</span> <span class="nf">imwrite</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write image to file.</span>

<span class="sd">    First scales the image to the interval [0 255].</span>

<span class="sd">    Args:</span>
<span class="sd">        fname (str): Filename.</span>
<span class="sd">        data (ndarray): 2D image array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">255</span><span class="o">*</span><span class="n">data</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="save_image"><a class="viewcode-back" href="../../tools.html#fart.tools.save_image">[docs]</a><span class="k">def</span> <span class="nf">save_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">image_format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save image to file.</span>

<span class="sd">    More convenient function than `imwrite` because it is easier to provide the</span>
<span class="sd">    directory and the image format.</span>

<span class="sd">    Args:</span>
<span class="sd">        img (ndarray): 2D image array.</span>
<span class="sd">        out_dir (str): Output directory.</span>
<span class="sd">        name (str): Filename.</span>
<span class="sd">        image_format (str): Image extension/format (default: &#39;png&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">imwrite</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">image_format</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span></div>


<div class="viewcode-block" id="save_matlab"><a class="viewcode-back" href="../../tools.html#fart.tools.save_matlab">[docs]</a><span class="k">def</span> <span class="nf">save_matlab</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save a matrix as .mat file</span>

<span class="sd">    The file will be saved in `&lt;out_dir&gt;/mat/img_&lt;name&gt;.mat` for some reason.</span>

<span class="sd">    Args:</span>
<span class="sd">        img (ndarray): 2D image array.</span>
<span class="sd">        out_dir (str): Output directory.</span>
<span class="sd">        name (str): Filename.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">create_dir</span><span class="p">(</span><span class="n">out_dir</span> <span class="o">+</span> <span class="s2">&quot;/mat&quot;</span><span class="p">)</span>
    <span class="n">savemat</span><span class="p">(</span><span class="n">out_dir</span> <span class="o">+</span> <span class="s2">&quot;/mat/img_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="nb">dict</span><span class="p">({</span><span class="s2">&quot;img_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">):</span> <span class="n">img</span><span class="p">}),</span> <span class="n">oned_as</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="display"><a class="viewcode-back" href="../../tools.html#fart.tools.display">[docs]</a><span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display a string without a trailing newline like the print command does.</span>

<span class="sd">    Args:</span>
<span class="sd">        string (str): String to print.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>


<div class="viewcode-block" id="dotc"><a class="viewcode-back" href="../../tools.html#fart.tools.dotc">[docs]</a><span class="k">def</span> <span class="nf">dotc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate complex dot product</span>
<span class="sd">    If y is not provided, &lt;x, x&gt; is calculated instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (ndarray): Vector.</span>
<span class="sd">        y (ndarray): Vector.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Complex dot product.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span></div>
    <span class="c1">#  return float(np.dot(x.flatten().real, y.flatten().real)) +\</span>
    <span class="c1">#      float(np.dot(x.flatten().imag, y.flatten().imag))</span>


<div class="viewcode-block" id="dual_energy"><a class="viewcode-back" href="../../tools.html#fart.tools.dual_energy">[docs]</a><span class="k">def</span> <span class="nf">dual_energy</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">alpha0</span><span class="p">,</span> <span class="n">show_text</span><span class="p">,</span> <span class="n">on_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate and print dual energy</span>

<span class="sd">    Args:</span>
<span class="sd">        u (gpuarray): Array.</span>
<span class="sd">        alpha0 (float): Regularization parameter.</span>
<span class="sd">        show_text (bool): If `True`, prints dual energy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Dual energy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">on_gpu</span><span class="p">:</span>
        <span class="n">dual_en</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dual_en</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">if</span> <span class="n">show_text</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TGV2-L2-2D-PD: alpha0 = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; dual energy = &quot;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="n">dual_en</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">dual_en</span></div>


<div class="viewcode-block" id="next_power_of_2"><a class="viewcode-back" href="../../tools.html#fart.tools.next_power_of_2">[docs]</a><span class="k">def</span> <span class="nf">next_power_of_2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine the next larger number which is a power of two.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (float): Input number.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Next larger number which is a power of two.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span></div>


<div class="viewcode-block" id="enlarge_next_power_of_2"><a class="viewcode-back" href="../../tools.html#fart.tools.enlarge_next_power_of_2">[docs]</a><span class="k">def</span> <span class="nf">enlarge_next_power_of_2</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine the next larger shape which is a power of two.</span>

<span class="sd">    Args:</span>
<span class="sd">        shape (array or tuple): Array of dimensions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Dimensions with are a power of two.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">new_shape</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">new_shape</span><span class="p">[:])))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_shape</span></div>


<span class="c1">###############################################################################</span>
<span class="c1"># FORWARD AND BACKWARD DIFFERENCES                                            #</span>
<span class="c1">###############################################################################</span>
<div class="viewcode-block" id="dyp"><a class="viewcode-back" href="../../tools.html#fart.tools.dyp">[docs]</a><span class="k">def</span> <span class="nf">dyp</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Backward finite differences in y direction.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (ndarray): 2D input array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Finite difference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span> <span class="o">-</span> <span class="n">u</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span></div>


<div class="viewcode-block" id="dxp"><a class="viewcode-back" href="../../tools.html#fart.tools.dxp">[docs]</a><span class="k">def</span> <span class="nf">dxp</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Backward finite differences in x direction.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (ndarray): 2D input array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Finite difference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">u</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">u</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span></div>


<div class="viewcode-block" id="dym"><a class="viewcode-back" href="../../tools.html#fart.tools.dym">[docs]</a><span class="k">def</span> <span class="nf">dym</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Forward finite differences in y direction.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (ndarray): 2D input array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Finite difference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">dtype</span><span class="p">)))</span> <span class="o">-</span> \
        <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span></div>


<div class="viewcode-block" id="dxm"><a class="viewcode-back" href="../../tools.html#fart.tools.dxm">[docs]</a><span class="k">def</span> <span class="nf">dxm</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Forward finite differences in x direction.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (ndarray): 2D input array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Finite difference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">dtype</span><span class="p">)))</span> <span class="o">-</span>\
        <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="n">u</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span></div>


<span class="c1">###############################################################################</span>
<span class="c1">#  GPU TOOLS                                                                  #</span>
<span class="c1">###############################################################################</span>
<div class="viewcode-block" id="format_tuple"><a class="viewcode-back" href="../../tools.html#fart.tools.format_tuple">[docs]</a><span class="k">def</span> <span class="nf">format_tuple</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">join_char</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Formats a tuple of Version numbers for printing.</span>

<span class="sd">    Example:</span>
<span class="sd">    (4, 2, 0) turns into 4.2.0</span>

<span class="sd">    Args:</span>
<span class="sd">        tup (tuple): Version as tuple.</span>
<span class="sd">        join_char (char): Character by which numbers are joined (default: &quot;.&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Joined version number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">join_char</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">tup</span><span class="p">)))</span></div>


<div class="viewcode-block" id="gpu_info"><a class="viewcode-back" href="../../tools.html#fart.tools.gpu_info">[docs]</a><span class="k">def</span> <span class="nf">gpu_info</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show GPU information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CUDA Version: &quot;</span> <span class="o">+</span> <span class="n">format_tuple</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_version</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CUDA Driver Version: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_driver_version</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of CUDA devices: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Device number &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Name of CUDA device: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">()))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Compute capability: &quot;</span> <span class="o">+</span>
              <span class="n">format_tuple</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">compute_capability</span><span class="p">()))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Total Memory: &quot;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">total_memory</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="mf">1024.0</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; MB&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Maximum number of threads per block: &quot;</span> <span class="o">+</span>
              <span class="nb">str</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">max_threads_per_block</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  PCI Bus ID: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">pci_bus_id</span><span class="p">()))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">get_attributes</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span></div>


<span class="c1"># Definition of a generic blocksize for the TGV update kernels</span>
<span class="c1">#: Generic blocksize in x</span>
<span class="n">block_size_x</span> <span class="o">=</span> <span class="mi">16</span>
<span class="c1">#: Generic blocksize in y</span>
<span class="n">block_size_y</span> <span class="o">=</span> <span class="mi">16</span>
<span class="c1">#: Generic block definition</span>
<span class="n">block</span> <span class="o">=</span> <span class="p">(</span><span class="n">block_size_x</span><span class="p">,</span> <span class="n">block_size_y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<div class="viewcode-block" id="get_grid"><a class="viewcode-back" href="../../tools.html#fart.tools.get_grid">[docs]</a><span class="k">def</span> <span class="nf">get_grid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes grid size based on block_size_x, block_size_y and the array</span>
<span class="sd">    size.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (ndarray): Input array for which gridsize should be calculated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: CUDA grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">offset</span><span class="p">]</span> <span class="o">+</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">offset</span><span class="p">]</span> <span class="o">+</span> <span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">grid</span></div>


<div class="viewcode-block" id="gpuarray_copy"><a class="viewcode-back" href="../../tools.html#fart.tools.gpuarray_copy">[docs]</a><span class="k">def</span> <span class="nf">gpuarray_copy</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copes a gpuarray object.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (gpuarray): Input array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarra: Deep copy of input array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">gpuarray</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">strides</span>
    <span class="n">cuda</span><span class="o">.</span><span class="n">memcpy_dtod</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">gpudata</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">gpudata</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span></div>


<div class="viewcode-block" id="dotc_gpu"><a class="viewcode-back" href="../../tools.html#fart.tools.dotc_gpu">[docs]</a><span class="k">def</span> <span class="nf">dotc_gpu</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate complex dot product on GPU.</span>
<span class="sd">    If y is not provided, &lt;x, x&gt; is calculated instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (ndarray): Vector.</span>
<span class="sd">        y (ndarray): Vector.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ndarray: Absolute of complex dot product.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">gpuarray</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span><span class="o">.</span><span class="n">get</span><span class="p">())</span></div>

<span class="n">add_scaled_vector_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *in1, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; scal, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *in2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;out[i] = in1[i] + scal * in2[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;add_scaled_vector&quot;</span><span class="p">,</span>
                      <span class="n">preamble</span><span class="o">=</span><span class="s2">&quot;#include &lt;pycuda-complex.hpp&gt;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="add_scaled_vector"><a class="viewcode-back" href="../../tools.html#fart.tools.add_scaled_vector">[docs]</a><span class="k">def</span> <span class="nf">add_scaled_vector</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the following (single precision) calculation on the GPU:</span>

<span class="sd">    ``out = inp1 + scal * inp2``</span>

<span class="sd">    Args:</span>
<span class="sd">        inp1 (gpuarray): First input array.</span>
<span class="sd">        inp2 (gpuarray): Second input array.</span>
<span class="sd">        scal (float): Scaling parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">add_scaled_vector_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">scal</span><span class="p">),</span> <span class="n">inp2</span><span class="p">)</span></div>


<span class="n">add_scaled_vector_double_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;double&gt; *out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *in1, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; scal, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *in2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;out[i] = in1[i] + scal * in2[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;add_scaled_vector_double&quot;</span><span class="p">,</span>
                      <span class="n">preamble</span><span class="o">=</span><span class="s2">&quot;#include &lt;pycuda-complex.hpp&gt;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="add_scaled_vector_double"><a class="viewcode-back" href="../../tools.html#fart.tools.add_scaled_vector_double">[docs]</a><span class="k">def</span> <span class="nf">add_scaled_vector_double</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the following (double precision) calculation on the GPU:</span>

<span class="sd">    ``out = inp1 + scal * inp2``</span>

<span class="sd">    Args:</span>
<span class="sd">        inp1 (gpuarray): First input array.</span>
<span class="sd">        inp2 (gpuarray): Second input array.</span>
<span class="sd">        scal (float): Scaling parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">add_scaled_vector_double_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">scal</span><span class="p">),</span> <span class="n">inp2</span><span class="p">)</span></div>


<span class="n">add_scaled_vector_vector_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *in1, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *scal, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *in2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;out[i] = in1[i] + scal[i] * in2[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;add_scaled_vector_vector&quot;</span><span class="p">,</span>
                      <span class="n">preamble</span><span class="o">=</span><span class="s2">&quot;#include &lt;pycuda-complex.hpp&gt;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="add_scaled_vector_vector"><a class="viewcode-back" href="../../tools.html#fart.tools.add_scaled_vector_vector">[docs]</a><span class="k">def</span> <span class="nf">add_scaled_vector_vector</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the following (single precision) calculation on the GPU:</span>

<span class="sd">    ``out = inp1 + scal * inp2``</span>

<span class="sd">    Args:</span>
<span class="sd">        inp1 (gpuarray): First input array.</span>
<span class="sd">        inp2 (gpuarray): Second input array.</span>
<span class="sd">        scal (gpuarray): Scaling array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">add_scaled_vector_vector_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">)</span></div>

<span class="n">add_scaled_vector_vector_double_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;double&gt; *out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *in1, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *scal, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *in2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;out[i] = in1[i] + scal[i] * in2[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;add_scaled_vector_vector_double&quot;</span><span class="p">,</span>
                      <span class="n">preamble</span><span class="o">=</span><span class="s2">&quot;#include &lt;pycuda-complex.hpp&gt;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="add_scaled_vector_vector_double"><a class="viewcode-back" href="../../tools.html#fart.tools.add_scaled_vector_vector_double">[docs]</a><span class="k">def</span> <span class="nf">add_scaled_vector_vector_double</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the following (double precision) calculation on the GPU:</span>

<span class="sd">    ``out = inp1 + scal * inp2``</span>

<span class="sd">    Args:</span>
<span class="sd">        inp1 (gpuarray): First input array.</span>
<span class="sd">        inp2 (gpuarray): Second input array.</span>
<span class="sd">        scal (gpuarray): Scaling array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">add_scaled_vector_vector_double_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">)</span></div>

<span class="n">sub_scaled_vector_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *in1, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; scal, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *in2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;out[i] = in1[i] - scal * in2[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;sub_scaled_vector&quot;</span><span class="p">,</span>
                      <span class="n">preamble</span><span class="o">=</span><span class="s2">&quot;#include &lt;pycuda-complex.hpp&gt;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="sub_scaled_vector"><a class="viewcode-back" href="../../tools.html#fart.tools.sub_scaled_vector">[docs]</a><span class="k">def</span> <span class="nf">sub_scaled_vector</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the following (single precision) calculation on the GPU:</span>

<span class="sd">    ``out = inp1 - scal * inp2``</span>

<span class="sd">    Args:</span>
<span class="sd">        inp1 (gpuarray): First input array.</span>
<span class="sd">        inp2 (gpuarray): Second input array.</span>
<span class="sd">        scal (float): Scaling parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sub_scaled_vector_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">scal</span><span class="p">),</span> <span class="n">inp2</span><span class="p">)</span></div>

<span class="n">sub_scaled_vector_double_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;double&gt; *out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *in1, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; scal, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;double&gt; *in2&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;out[i] = in1[i] - scal * in2[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;sub_scaled_vector_double&quot;</span><span class="p">,</span>
                      <span class="n">preamble</span><span class="o">=</span><span class="s2">&quot;#include &lt;pycuda-complex.hpp&gt;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="sub_scaled_vector_double"><a class="viewcode-back" href="../../tools.html#fart.tools.sub_scaled_vector_double">[docs]</a><span class="k">def</span> <span class="nf">sub_scaled_vector_double</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">scal</span><span class="p">,</span> <span class="n">inp2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the following (double precision) calculation on the GPU:</span>

<span class="sd">    ``out = inp1 - scal * inp2``</span>

<span class="sd">    Args:</span>
<span class="sd">        inp1 (gpuarray): First input array.</span>
<span class="sd">        inp2 (gpuarray): Second input array.</span>
<span class="sd">        scal (float): Scaling parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sub_scaled_vector_double_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">inp1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">scal</span><span class="p">),</span> <span class="n">inp2</span><span class="p">)</span></div>

<span class="n">inplace_mul</span> <span class="o">=</span> <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *x, </span><span class="se">\</span>
<span class="s2">                                pycuda::complex&lt;float&gt; *y&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;x[i] *= y[i]&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;inplace_mul&quot;</span><span class="p">)</span>

<span class="n">sens_mul_func</span> <span class="o">=</span> <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *out, </span><span class="se">\</span>
<span class="s2">                                  pycuda::complex&lt;float&gt; *u, </span><span class="se">\</span>
<span class="s2">                                  pycuda::complex&lt;float&gt; *sens, </span><span class="se">\</span>
<span class="s2">                                  int coil, int n_coils&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;out[i] = sens[n_coils*i + coil] * u[i]&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;sens_mul&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="sens_mul"><a class="viewcode-back" href="../../tools.html#fart.tools.sens_mul">[docs]</a><span class="k">def</span> <span class="nf">sens_mul</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">sens</span><span class="p">,</span> <span class="n">coil</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiply an array with the coil sensitivity</span>

<span class="sd">    ``out = u * sens[coil]``</span>

<span class="sd">    Args:</span>
<span class="sd">        out (gpuarray): Output array.</span>
<span class="sd">        u (gpuarray): Input array.</span>
<span class="sd">        sens (gpuarray): RF sensitivity maps for all RF coils.</span>
<span class="sd">        coil (int): Coil index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sens_mul_func</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">sens</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">coil</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">sens</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span></div>

<span class="n">conj_sens_mul_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *u, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *v, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *sens, </span><span class="se">\</span>
<span class="s2">                      int coil, int n_coils&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;u[i] += conj(sens[n_coils*i + coil]) * v[i]&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;conj_sens_mul&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="conj_sens_mul"><a class="viewcode-back" href="../../tools.html#fart.tools.conj_sens_mul">[docs]</a><span class="k">def</span> <span class="nf">conj_sens_mul</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sens</span><span class="p">,</span> <span class="n">coil</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiply an array ``v`` with the coil sensitivity ``sens`` and add it</span>
<span class="sd">    to ``u``</span>

<span class="sd">    ``u = u + v * conj(sens[coil])``</span>

<span class="sd">    Args:</span>
<span class="sd">        u (gpuarray): Array.</span>
<span class="sd">        v (gpuarray): Array.</span>
<span class="sd">        sens (gpuarray): RF sensitivity maps for all RF coils.</span>
<span class="sd">        coil (int): Coil index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">conj_sens_mul_func</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">sens</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">coil</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">sens</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span></div>

<span class="n">slice_coil_func</span> <span class="o">=</span> <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *out, </span><span class="se">\</span>
<span class="s2">                                    pycuda::complex&lt;float&gt; *in, </span><span class="se">\</span>
<span class="s2">                                    int coil, int dim&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;out[i] = in[dim*i + coil]&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;slice_coil&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="slice_coil"><a class="viewcode-back" href="../../tools.html#fart.tools.slice_coil">[docs]</a><span class="k">def</span> <span class="nf">slice_coil</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">outp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coil</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a slice of a 3D-Array (image stack or coil sensitivity) since</span>
<span class="sd">    slicing is not implemented in PyCUDA.</span>

<span class="sd">    Args:</span>
<span class="sd">        inp (gpuarray): Input array.</span>
<span class="sd">        outp (gpuarray): Output slice (optional, if not provided, it will be</span>
<span class="sd">            created).</span>
<span class="sd">        coil (int): Coil index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_coils</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">outp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outp</span> <span class="o">=</span> <span class="n">gpuarray</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">slice_coil_func</span><span class="p">(</span><span class="n">outp</span><span class="p">,</span> <span class="n">inp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">coil</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">n_coils</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">outp</span></div>

<span class="n">x_sn_mul_func</span> <span class="o">=</span> \
    <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *x_out, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *x, </span><span class="se">\</span>
<span class="s2">                      pycuda::complex&lt;float&gt; *sn, </span><span class="se">\</span>
<span class="s2">                      int Nd1, int Kd1&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;x_out[i] = x[(i%Nd1)*Kd1+(i/Nd1)] * conj(sn[i])&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;x_sn_mul&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="x_sn_mul"><a class="viewcode-back" href="../../tools.html#fart.tools.x_sn_mul">[docs]</a><span class="k">def</span> <span class="nf">x_sn_mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sn</span><span class="p">,</span> <span class="n">Nd</span><span class="p">,</span> <span class="n">Kd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiply ``x`` by ``conj(sn)`` while taking care of the dimensions</span>
<span class="sd">    (needed for NUFFT package)</span>

<span class="sd">    Args:</span>
<span class="sd">        x (gpuarray): Input array.</span>
<span class="sd">        sn (gpuarray): sn array.</span>
<span class="sd">        Nd (int): Dimension.</span>
<span class="sd">        Kd (int): Dimension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xout</span> <span class="o">=</span> <span class="n">gpuarray</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">Nd</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Nd</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">x_sn_mul_func</span><span class="p">(</span><span class="n">xout</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">sn</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">Nd</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">Kd</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">xout</span></div>

<span class="n">arr_pad_func</span> <span class="o">=</span> <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *in, </span><span class="se">\</span>
<span class="s2">                                 pycuda::complex&lt;float&gt; *out, </span><span class="se">\</span>
<span class="s2">                                 int dim_in, int dim_out&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;out[(i</span><span class="si">%d</span><span class="s2">im_in)+(i/dim_in)*dim_out] = in[i]&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;arr_pad&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="arr_pad"><a class="viewcode-back" href="../../tools.html#fart.tools.arr_pad">[docs]</a><span class="k">def</span> <span class="nf">arr_pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dims</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Basically zeropadding an array to ``dims`` dimensions.</span>
<span class="sd">    Implemented as follows:</span>
<span class="sd">    Write a smaller array into a bigger one. The bigger array will be created</span>
<span class="sd">    according to ``dims``. The place of the smaller matrix will be in the upper</span>
<span class="sd">    left corner of the bigger array.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (gpuarray): Input array.</span>
<span class="sd">        dims (tuple): Dimensions of the bigger array.</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpuarray: Output array of size `dims` with `x` in the upper left</span>
<span class="sd">            corner.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">gpuarray</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">arr_pad_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">out</span></div>

<span class="n">fill_v_func</span> <span class="o">=</span> <span class="n">ElementwiseKernel</span><span class="p">(</span><span class="s2">&quot;pycuda::complex&lt;float&gt; *v_in, </span><span class="se">\</span>
<span class="s2">                                pycuda::complex&lt;float&gt; *v_full, </span><span class="se">\</span>
<span class="s2">                                int coil, int dim&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;v_full[dim*i + coil] = v_in[i]&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;v_fill&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="fill_v"><a class="viewcode-back" href="../../tools.html#fart.tools.fill_v">[docs]</a><span class="k">def</span> <span class="nf">fill_v</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">vin</span><span class="p">,</span> <span class="n">coil</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write one slice in to a 3D stack of images.</span>

<span class="sd">    Args:</span>
<span class="sd">        v (gpuarray): 3D array.</span>
<span class="sd">        vin (gpuarray): 2D input array.</span>
<span class="sd">        coil (int): RF coil index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">fill_v_func</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">coil</span><span class="p">),</span> <span class="n">dim</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">FART</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reconfile.html">ReconData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tgv.html">Total Generalized Variation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tgv_kernels.html">TGV Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cg.html">Conjugate Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Tools</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Stefan Kroboth.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>